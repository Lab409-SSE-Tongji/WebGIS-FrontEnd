<template>
  <div class="wrapper wrapper-content animated fadeInRight">
    <div class="form-inline">
      <label>Google map</label>
      <label>
        <select class="form-control"  v-on:change="layerSelectChange">
          <option value="-1">选择图层</option>
          <option value="0">图层1</option>
          <option value="1">图层2</option>
        </select>
      </label>
    </div>
    <div class="ibox-content" id="map" style="position: relative; height: 820px"></div>
  </div>
</template>

<script>
  var map;
  var curLayer = -1;
  var flightLayer = [];
  function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
      center: {lat: 31.23, lng: 121.47 },
      zoom: 9
    });

    var pointData = [
      [
        [[121.516999, 31.2104], [121.516986, 31.210503], [121.516571, 31.21086], [121.516175, 31.210995], [121.515357, 31.21111], [121.515173, 31.211243], [121.514467, 31.211573], [121.514422, 31.211668], [121.514693, 31.21226], [121.51506, 31.213155], [121.515159, 31.21387], [121.514904, 31.215124], [121.514454, 31.216457], [121.514257, 31.217126], [121.513873, 31.217396], [121.513669, 31.217685], [121.513584, 31.218159], [121.513501, 31.218226], [121.512937, 31.219363], [121.512471, 31.220575], [121.512369, 31.220709], [121.512234, 31.221627], [121.512219, 31.22175], [121.512176, 31.221893], [121.512171, 31.222027], [121.511949, 31.223441], [121.511478, 31.22442], [121.511465, 31.224518], [121.511483, 31.224666], [121.511152, 31.224982], [121.511089, 31.22511], [121.51102, 31.225177], [121.510756, 31.225428], [121.510529, 31.22569], [121.509478, 31.226252], [121.508977, 31.226424], [121.508478, 31.227095], [121.508026, 31.227212], [121.507057, 31.227766], [121.506431, 31.228503], [121.505993, 31.229445], [121.505261, 31.23028], [121.504598, 31.231122], [121.504397, 31.231476], [121.50441, 31.231723], [121.504295, 31.231985], [121.50413, 31.232016], [121.50407, 31.232172], [121.504031, 31.232242], [121.504442, 31.232868], [121.504493, 31.233516], [121.504515, 31.235682], [121.504524, 31.235722], [121.504505, 31.235752], [121.504594, 31.235792], [121.504221, 31.23602], [121.504135, 31.236476], [121.50432, 31.237123], [121.50559, 31.239415], [121.506056, 31.239937], [121.506302, 31.239993], [121.506433, 31.239998]],
        [[121.46514, 31.281129], [121.465131, 31.280976], [121.465063, 31.280277], [121.465083, 31.279587], [121.46528, 31.278798], [121.465459, 31.27791], [121.465629, 31.27717], [121.465609, 31.276909], [121.465604, 31.276844], [121.465583, 31.276769], [121.465759, 31.276123], [121.465621, 31.275608], [121.465618, 31.274813], [121.465561, 31.274171], [121.465466, 31.274124], [121.465441, 31.274044], [121.46519, 31.273854], [121.465459, 31.273392], [121.465792, 31.272927], [121.466247, 31.27233], [121.466734, 31.271677], [121.467114, 31.271147], [121.46747, 31.270624], [121.467751, 31.270291], [121.468065, 31.269938], [121.468414, 31.269374], [121.468851, 31.268772], [121.469237, 31.268222], [121.469626, 31.26772], [121.470132, 31.267131], [121.470578, 31.266743], [121.471062, 31.266311], [121.471505, 31.2659], [121.471939, 31.265446], [121.472378, 31.265045], [121.472913, 31.264515], [121.473498, 31.263936], [121.473975, 31.263505], [121.474047, 31.26349], [121.474684, 31.262931], [121.475433, 31.262427], [121.476329, 31.261835], [121.477035, 31.261228], [121.477533, 31.260816], [121.478224, 31.26026], [121.47893, 31.2596], [121.479347, 31.259206], [121.479394, 31.259155], [121.479516, 31.259058], [121.479733, 31.258994], [121.480249, 31.258744], [121.481106, 31.258383], [121.481355, 31.258275], [121.482257, 31.258035], [121.48295, 31.257778], [121.483057, 31.257857], [121.483151, 31.257784], [121.484352, 31.257083], [121.484784, 31.256874], [121.485355, 31.25633], [121.485807, 31.255619], [121.485914, 31.25488], [121.485977, 31.25473], [121.486305, 31.254457], [121.486443, 31.254374], [121.486436, 31.254359], [121.486475, 31.254318], [121.486524, 31.254288], [121.486525, 31.254259], [121.486894, 31.253963], [121.487919, 31.253063], [121.488216, 31.252678], [121.488286, 31.252413]]
      ],
      [
        [[121.50985, 31.185174], [121.509848, 31.185259], [121.509823, 31.185926], [121.5098, 31.186632], [121.509808, 31.187448], [121.50982, 31.18791], [121.509722, 31.188636], [121.509642, 31.189017], [121.509682, 31.189104], [121.510409, 31.189411], [121.511443, 31.189962], [121.512306, 31.190454], [121.514429, 31.193007], [121.514291, 31.19346], [121.514131, 31.193715], [121.513717, 31.19425], [121.513383, 31.19471], [121.513025, 31.195119], [121.512624, 31.195646], [121.512158, 31.196468], [121.511645, 31.19726], [121.511058, 31.197757], [121.510794, 31.198068], [121.510799, 31.1981], [121.510912, 31.198267], [121.511533, 31.198974], [121.512181, 31.199816], [121.512646, 31.200665], [121.51307, 31.201675], [121.513521, 31.202785], [121.513918, 31.203736], [121.514295, 31.204063], [121.514802, 31.204146], [121.515848, 31.203858], [121.516503, 31.203475], [121.516655, 31.203106], [121.516532, 31.202641], [121.516097, 31.202324], [121.515629, 31.202273], [121.514607, 31.20248], [121.513489, 31.20269], [121.510086, 31.203807], [121.5089, 31.204216], [121.507724, 31.204645], [121.506593, 31.205052], [121.505449, 31.205475], [121.504332, 31.205883], [121.503151, 31.206317], [121.502, 31.206745], [121.501049, 31.207104], [121.500595, 31.207548], [121.500466, 31.208116], [121.500696, 31.20867], [121.501248, 31.209045], [121.501951, 31.209113], [121.502589, 31.208858], [121.502973, 31.208363], [121.502993, 31.207784], [121.502686, 31.207389], [121.502168, 31.20719], [121.501485, 31.207292], [121.501052, 31.207652], [121.500904, 31.208112], [121.500907, 31.208194], [121.500982, 31.209035], [121.501015, 31.209556], [121.501002, 31.209821], [121.500995, 31.210106], [121.500701, 31.210824], [121.500001, 31.211296], [121.49972, 31.211329], [121.498664, 31.211456], [121.49802, 31.211845], [121.49748, 31.21259], [121.497088, 31.212996], [121.496636, 31.213195], [121.496033, 31.213192], [121.495751, 31.213275], [121.495751, 31.213352], [121.495758, 31.213562], [121.495758, 31.213593], [121.495756, 31.213623], [121.495756, 31.213652], [121.495784, 31.213875], [121.495791, 31.214003], [121.495793, 31.214045], [121.495789, 31.214083]],
      ]
    ];
    var colorData = ['#0000ff','black'];

    for(let layerPos in pointData){
      let curFlightLayer = [];
      for(let linePos in pointData[layerPos]){
        let line = [];
        for(let pointPos in pointData[layerPos][linePos]){
          line.push({lat:pointData[layerPos][linePos][pointPos][1],
            lng:pointData[layerPos][linePos][pointPos][0]});
        }
        let flightPath = new google.maps.Polyline({
          path: line,
          geodesic: true,
          strokeColor: colorData[layerPos],
          strokeOpacity: 0.5,
          strokeWeight: 3,
        });
        curFlightLayer.push(flightPath);
      }
      flightLayer.push(curFlightLayer);
    }
  }

  export default {
    name: 'googleMapPage' ,
    mounted(){
      initMap();
    },
    methods:{
      layerSelectChange:function (event) {
        var selectVal = event.target.value;
        if(curLayer!=-1) {
          for(let pos in flightLayer[curLayer]) {
            flightLayer[curLayer][pos].setMap(null);
          }
        }
        curLayer = selectVal;
        if(selectVal != -1) {
          for(let pos in flightLayer[curLayer]) {
            flightLayer[curLayer][pos].setMap(map);
          }
        }
      }
    }

  }
</script>



